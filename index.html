<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackSnow Danny - Professional Writing Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=Inter:wght@300;400;500;600;700&display=swap');
        
        .font-serif { font-family: 'Crimson Text', serif; }
        .font-sans { font-family: 'Inter', sans-serif; }
        
        .writing-area {
            min-height: 500px;
            line-height: 1.8;
        }
        
        .fade-in {
            animation: fadeIn 0.4s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .hover-lift:hover {
            transform: translateY(-3px);
            transition: transform 0.3s ease;
        }
        
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.9);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-purple-50 min-h-screen font-sans">
    
    <!-- Authentication Pages -->
    <div id="auth-container" class="min-h-screen flex items-center justify-center p-4">
        <!-- Login Page -->
        <div id="login-page" class="w-full max-w-md">
            <div class="glass-effect rounded-3xl shadow-2xl border border-white/20 p-8">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <span class="text-white font-bold text-2xl">BD</span>
                    </div>
                    <h1 class="text-3xl font-bold gradient-text mb-2">BlackSnow Danny</h1>
                    <p class="text-gray-600">Professional Writing Platform</p>
                </div>
                
                <form id="login-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="login-email" required 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                        <input type="password" id="login-password" required 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all transform hover:scale-105">
                        Sign In
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">Don't have an account? 
                        <button onclick="showSignup()" class="text-indigo-600 font-semibold hover:text-indigo-800 transition-colors">Sign up</button>
                    </p>
                </div>
                
                <div id="login-error" class="mt-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700 text-sm hidden"></div>
            </div>
        </div>
        
        <!-- Signup Page -->
        <div id="signup-page" class="w-full max-w-md hidden">
            <div class="glass-effect rounded-3xl shadow-2xl border border-white/20 p-8">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
                        <span class="text-white font-bold text-2xl">BD</span>
                    </div>
                    <h1 class="text-3xl font-bold gradient-text mb-2">Join BlackSnow Danny</h1>
                    <p class="text-gray-600">Create your writing account</p>
                </div>
                
                <form id="signup-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Full Name</label>
                        <input type="text" id="signup-name" required 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Email Address</label>
                        <input type="email" id="signup-email" required 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                        <input type="password" id="signup-password" required minlength="6"
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                        <p class="text-xs text-gray-500 mt-1">Minimum 6 characters</p>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Confirm Password</label>
                        <input type="password" id="signup-confirm" required 
                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white/50">
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 transition-all transform hover:scale-105">
                        Create Account
                    </button>
                </form>
                
                <div class="mt-6 text-center">
                    <p class="text-gray-600">Already have an account? 
                        <button onclick="showLogin()" class="text-indigo-600 font-semibold hover:text-indigo-800 transition-colors">Sign in</button>
                    </p>
                </div>
                
                <div id="signup-error" class="mt-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700 text-sm hidden"></div>
                <div id="signup-success" class="mt-4 p-3 bg-green-100 border border-green-300 rounded-lg text-green-700 text-sm hidden"></div>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="hidden">
        <!-- Header -->
        <header class="glass-effect border-b border-indigo-100 sticky top-0 z-50">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <div class="w-12 h-12 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl flex items-center justify-center">
                            <span class="text-white font-bold text-xl">BD</span>
                        </div>
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">BlackSnow Danny</h1>
                            <p class="text-sm text-gray-600">Professional Writing Platform</p>
                        </div>
                    </div>
                    
                    <!-- Desktop Navigation -->
                    <nav class="hidden lg:flex items-center space-x-6">
                        <button onclick="showSection('dashboard')" class="nav-btn text-indigo-600 font-medium hover:text-indigo-800 transition-colors">Dashboard</button>
                        <button onclick="showSection('write')" class="nav-btn text-gray-600 font-medium hover:text-indigo-600 transition-colors">Write</button>
                        <button onclick="showSection('library')" class="nav-btn text-gray-600 font-medium hover:text-indigo-600 transition-colors">Library</button>
                        <button onclick="showSection('analytics')" class="nav-btn text-gray-600 font-medium hover:text-indigo-600 transition-colors">Analytics</button>
                        
                        <div class="flex items-center space-x-4 ml-6 pl-6 border-l border-gray-200">
                            <span id="user-name" class="text-gray-700 font-medium"></span>
                            <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm">
                                Logout
                            </button>
                        </div>
                    </nav>
                    
                    <!-- Mobile Menu Button -->
                    <button onclick="toggleMobileMenu()" class="lg:hidden p-2 rounded-lg hover:bg-gray-100 transition-colors">
                        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </header>
        
        <!-- Mobile Navigation Menu -->
        <div id="mobile-menu" class="lg:hidden hidden bg-white border-b border-gray-200 shadow-lg">
            <div class="max-w-7xl mx-auto px-6 py-4">
                <div class="flex flex-col space-y-4">
                    <button onclick="showSection('dashboard'); closeMobileMenu()" class="mobile-nav-btn text-left text-indigo-600 font-medium py-2 px-4 rounded-lg hover:bg-indigo-50 transition-colors">
                        📊 Dashboard
                    </button>
                    <button onclick="showSection('write'); closeMobileMenu()" class="mobile-nav-btn text-left text-gray-600 font-medium py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                        ✍️ Write
                    </button>
                    <button onclick="showSection('library'); closeMobileMenu()" class="mobile-nav-btn text-left text-gray-600 font-medium py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                        📚 Library
                    </button>
                    <button onclick="showSection('analytics'); closeMobileMenu()" class="mobile-nav-btn text-left text-gray-600 font-medium py-2 px-4 rounded-lg hover:bg-gray-50 transition-colors">
                        📈 Analytics
                    </button>
                    <div class="border-t border-gray-200 pt-4 mt-4">
                        <div class="flex items-center justify-between">
                            <span id="mobile-user-name" class="text-gray-700 font-medium"></span>
                            <button onclick="logout()" class="bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-colors text-sm">
                                Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <main class="max-w-7xl mx-auto px-4 sm:px-6 py-4 sm:py-8">
            
            <!-- Dashboard Section -->
            <section id="dashboard-section" class="fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8 mb-6 sm:mb-8">
                    <!-- Welcome Card -->
                    <div class="lg:col-span-2 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-6 sm:p-8 text-white">
                        <h2 class="text-2xl sm:text-3xl font-bold mb-4">Welcome back, <span id="dashboard-name"></span>!</h2>
                        <p class="text-indigo-100 mb-6">Continue your writing journey. Your creativity awaits.</p>
                        <button onclick="showSection('write')" class="bg-white text-indigo-600 px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-colors">
                            Start Writing
                        </button>
                    </div>
                    
                    <!-- Quick Stats -->
                    <div class="grid grid-cols-2 lg:grid-cols-1 gap-4 lg:space-y-0">
                        <div class="bg-white rounded-xl p-4 sm:p-6 border border-gray-100 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm">Total Works</p>
                                    <p id="total-works" class="text-xl sm:text-2xl font-bold text-gray-800">0</p>
                                </div>
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-indigo-100 rounded-lg flex items-center justify-center">
                                    <span class="text-indigo-600 text-lg sm:text-xl">📚</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-xl p-4 sm:p-6 border border-gray-100 shadow-sm">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-600 text-sm">Total Words</p>
                                    <p id="total-words" class="text-xl sm:text-2xl font-bold text-gray-800">0</p>
                                </div>
                                <div class="w-10 h-10 sm:w-12 sm:h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                                    <span class="text-purple-600 text-lg sm:text-xl">✍️</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Works -->
                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-8">
                    <h3 class="text-xl font-bold text-gray-800 mb-6">Recent Works</h3>
                    <div id="recent-works" class="space-y-4">
                        <p class="text-gray-500 text-center py-8">No works yet. Start writing to see them here!</p>
                    </div>
                </div>
            </section>
            
            <!-- Writing Section -->
            <section id="write-section" class="hidden fade-in">
                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 px-8 py-6">
                        <h2 class="text-2xl font-bold text-white mb-2">Create Your Masterpiece</h2>
                        <p class="text-indigo-100">Professional writing environment with auto-save</p>
                    </div>
                    
                    <div class="p-4 sm:p-8">
                        <div class="grid grid-cols-1 xl:grid-cols-4 gap-6 xl:gap-8">
                            <!-- Writing Form -->
                            <div class="xl:col-span-3">
                                <div class="space-y-4 sm:space-y-6">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6">
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Title</label>
                                            <input type="text" id="work-title" placeholder="Enter your title..." 
                                                   class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                                        </div>
                                        
                                        <div>
                                            <label class="block text-sm font-semibold text-gray-700 mb-2">Category</label>
                                            <select id="work-type" class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                                                <option value="poem">Poetry</option>
                                                <option value="story">Short Story</option>
                                                <option value="novel-chapter">Novel Chapter</option>
                                                <option value="essay">Essay</option>
                                                <option value="screenplay">Screenplay</option>
                                                <option value="other">Other</option>
                                            </select>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2">Tags (optional)</label>
                                        <input type="text" id="work-tags" placeholder="romance, adventure, mystery..." 
                                               class="w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-sm font-semibold text-gray-700 mb-2">Your Writing</label>
                                        <textarea id="work-content" placeholder="Begin your masterpiece here..." 
                                                  class="w-full writing-area px-6 py-6 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none font-serif text-lg leading-relaxed transition-all"></textarea>
                                    </div>
                                    
                                    <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4">
                                        <button onclick="saveWork()" class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white px-6 sm:px-8 py-3 rounded-xl hover:from-indigo-700 hover:to-purple-700 transition-all font-semibold transform hover:scale-105">
                                            💾 Save Work
                                        </button>
                                        <button onclick="clearEditor()" class="bg-gray-100 text-gray-700 px-6 sm:px-8 py-3 rounded-xl hover:bg-gray-200 transition-colors font-semibold">
                                            🗑️ Clear
                                        </button>
                                        <button onclick="exportCurrentWork()" class="bg-green-600 text-white px-6 sm:px-8 py-3 rounded-xl hover:bg-green-700 transition-colors font-semibold">
                                            📥 Export
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Writing Tools & Stats -->
                            <div class="space-y-4 sm:space-y-6">
                                <div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-4 sm:p-6 border border-purple-100">
                                    <h3 class="font-bold text-gray-800 mb-4">📊 Writing Stats</h3>
                                    <div class="space-y-3">
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Words:</span>
                                            <span id="word-count" class="font-bold text-indigo-600">0</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Characters:</span>
                                            <span id="char-count" class="font-bold text-indigo-600">0</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Paragraphs:</span>
                                            <span id="para-count" class="font-bold text-indigo-600">0</span>
                                        </div>
                                        <div class="flex justify-between">
                                            <span class="text-gray-600">Reading Time:</span>
                                            <span id="read-time" class="font-bold text-indigo-600">0 min</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-6 border border-amber-100">
                                    <h3 class="font-bold text-gray-800 mb-4">💡 Writing Tip</h3>
                                    <p class="text-gray-700 text-sm leading-relaxed" id="writing-tip"></p>
                                    <button onclick="showRandomTip()" class="mt-3 text-amber-600 text-xs font-semibold hover:text-amber-800 transition-colors">
                                        New Tip
                                    </button>
                                </div>
                                
                                <div class="bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 border border-green-100">
                                    <h3 class="font-bold text-gray-800 mb-4">⚡ Auto-Save</h3>
                                    <div class="flex items-center space-x-2">
                                        <div id="save-indicator" class="w-3 h-3 bg-green-500 rounded-full"></div>
                                        <span class="text-sm text-gray-600">Saved automatically</span>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-2">Last saved: <span id="last-saved">Never</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Library Section -->
            <section id="library-section" class="hidden fade-in">
                <div class="bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden">
                    <div class="bg-gradient-to-r from-purple-600 to-indigo-600 px-8 py-6">
                        <h2 class="text-2xl font-bold text-white mb-2">My Writing Library</h2>
                        <p class="text-purple-100">Your complete collection of literary works</p>
                    </div>
                    
                    <div class="p-4 sm:p-8">
                        <div class="flex flex-col space-y-4 mb-6 sm:mb-8">
                            <div class="flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4">
                                <select id="filter-type" onchange="filterWorks()" class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm">
                                    <option value="all">All Categories</option>
                                    <option value="poem">Poetry</option>
                                    <option value="story">Short Stories</option>
                                    <option value="novel-chapter">Novel Chapters</option>
                                    <option value="essay">Essays</option>
                                    <option value="screenplay">Screenplays</option>
                                    <option value="other">Other</option>
                                </select>
                                
                                <select id="sort-by" onchange="filterWorks()" class="px-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm">
                                    <option value="newest">Newest First</option>
                                    <option value="oldest">Oldest First</option>
                                    <option value="title">Title A-Z</option>
                                    <option value="words">Most Words</option>
                                </select>
                                
                                <span id="works-count" class="text-gray-600 text-sm font-medium">0 works</span>
                            </div>
                            
                            <div class="flex flex-col sm:flex-row items-stretch sm:items-center gap-3">
                                <button onclick="exportAllWorks()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors font-medium text-sm">
                                    📥 Export All
                                </button>
                                <button onclick="clearAllWorks()" class="text-red-600 hover:text-red-800 text-sm font-medium transition-colors py-2">
                                    Clear All
                                </button>
                            </div>
                        </div>
                        
                        <div id="works-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            <div class="text-center py-16 col-span-full">
                                <div class="text-6xl mb-4">📚</div>
                                <h3 class="text-xl font-semibold text-gray-600 mb-2">Your library awaits</h3>
                                <p class="text-gray-500">Start writing to build your collection</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Analytics Section -->
            <section id="analytics-section" class="hidden fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-8">
                    <!-- Writing Statistics -->
                    <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-6 sm:p-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-6">📈 Writing Statistics</h3>
                        <div class="space-y-6">
                            <div class="flex items-center justify-between p-4 bg-indigo-50 rounded-xl">
                                <div>
                                    <p class="text-sm text-gray-600">Total Works</p>
                                    <p id="analytics-total-works" class="text-2xl font-bold text-indigo-600">0</p>
                                </div>
                                <div class="text-3xl">📚</div>
                            </div>
                            
                            <div class="flex items-center justify-between p-4 bg-purple-50 rounded-xl">
                                <div>
                                    <p class="text-sm text-gray-600">Total Words Written</p>
                                    <p id="analytics-total-words" class="text-2xl font-bold text-purple-600">0</p>
                                </div>
                                <div class="text-3xl">✍️</div>
                            </div>
                            
                            <div class="flex items-center justify-between p-4 bg-green-50 rounded-xl">
                                <div>
                                    <p class="text-sm text-gray-600">Average Words per Work</p>
                                    <p id="analytics-avg-words" class="text-2xl font-bold text-green-600">0</p>
                                </div>
                                <div class="text-3xl">📊</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Category Breakdown -->
                    <div class="bg-white rounded-2xl shadow-xl border border-gray-100 p-8">
                        <h3 class="text-xl font-bold text-gray-800 mb-6">📋 Category Breakdown</h3>
                        <div id="category-stats" class="space-y-4">
                            <p class="text-gray-500 text-center py-8">No data available yet</p>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-6 sm:py-8 mt-12 sm:mt-16">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 text-center">
                <div class="space-y-2">
                    <p class="text-base sm:text-lg font-semibold">💝 BlackSnow loves Danny 💝</p>
                    <p class="text-indigo-100 text-sm sm:text-base">This is a present from BlackSnow to Rosita</p>
                    <p class="text-xs text-indigo-200 mt-4">Professional Writing Platform • Secure & Private</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Work Detail Modal -->
    <div id="work-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-2 sm:p-4">
        <div class="bg-white rounded-2xl max-w-5xl w-full max-h-[95vh] sm:max-h-[90vh] overflow-hidden">
            <div class="bg-gradient-to-r from-indigo-600 to-purple-600 px-4 sm:px-6 py-4 flex items-center justify-between">
                <h3 id="modal-title" class="text-lg sm:text-xl font-bold text-white truncate mr-4"></h3>
                <button onclick="closeModal()" class="text-white hover:text-gray-200 text-2xl font-bold flex-shrink-0">&times;</button>
            </div>
            <div class="p-4 sm:p-8 overflow-y-auto max-h-[calc(95vh-80px)] sm:max-h-[calc(90vh-80px)]">
                <div class="mb-4 sm:mb-6 flex flex-wrap items-center gap-2 sm:gap-4">
                    <span id="modal-type" class="inline-block bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-xs sm:text-sm font-semibold"></span>
                    <span id="modal-date" class="text-gray-500 text-xs sm:text-sm"></span>
                    <span id="modal-word-count" class="text-gray-500 text-xs sm:text-sm"></span>
                </div>
                <div id="modal-tags" class="mb-4 sm:mb-6"></div>
                <div id="modal-content" class="font-serif text-base sm:text-lg leading-relaxed whitespace-pre-wrap prose max-w-none"></div>
                <div class="mt-6 sm:mt-8 flex flex-col sm:flex-row items-stretch sm:items-center gap-3 sm:gap-4 pt-6 border-t border-gray-200">
                    <button onclick="editWork()" class="bg-indigo-600 text-white px-4 sm:px-6 py-3 rounded-xl hover:bg-indigo-700 transition-colors font-semibold text-sm sm:text-base">
                        ✏️ Edit
                    </button>
                    <button onclick="deleteWork()" class="bg-red-600 text-white px-4 sm:px-6 py-3 rounded-xl hover:bg-red-700 transition-colors font-semibold text-sm sm:text-base">
                        🗑️ Delete
                    </button>
                    <button onclick="exportWork()" class="bg-gray-600 text-white px-4 sm:px-6 py-3 rounded-xl hover:bg-gray-700 transition-colors font-semibold text-sm sm:text-base">
                        📥 Export
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // User Management System
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('bd-users') || '{}');
        let works = [];
        let currentWorkId = null;
        
        const writingTips = [
            "Start with a single image or emotion. Let it guide your words and see where it takes you.",
            "Read your work aloud. Your ears will catch what your eyes miss.",
            "Don't edit while you write. Let the words flow first, polish later.",
            "Every great writer was once a beginner. Keep writing, keep improving.",
            "Show, don't tell. Let your readers experience the story through actions and dialogue.",
            "Write what you know, but don't be afraid to explore what you don't.",
            "The first draft is just you telling yourself the story. Make it count.",
            "Keep a notebook nearby. Inspiration strikes at the most unexpected moments.",
            "Character development is key. Give your characters real motivations and flaws.",
            "Set a daily writing goal and stick to it, even if it's just 100 words.",
            "Research thoroughly, but don't let it become procrastination.",
            "Join a writing community. Feedback and support are invaluable."
        ];

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            setupEventListeners();
        });

        function checkAuthStatus() {
            const savedUser = localStorage.getItem('bd-current-user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showApp();
            } else {
                showAuth();
            }
        }

        function setupEventListeners() {
            // Auth forms
            document.getElementById('login-form').addEventListener('submit', handleLogin);
            document.getElementById('signup-form').addEventListener('submit', handleSignup);
            
            // Writing area
            document.getElementById('work-content').addEventListener('input', updateWordCount);
            
            // Auto-save
            setInterval(autoSave, 30000); // Every 30 seconds
        }

        // Authentication Functions
        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value.trim().toLowerCase();
            const password = document.getElementById('login-password').value;
            
            if (!users[email]) {
                showError('login-error', 'Account not found. Please check your email or sign up.');
                return;
            }
            
            if (users[email].password !== password) {
                showError('login-error', 'Invalid password. Please try again.');
                return;
            }
            
            currentUser = users[email];
            localStorage.setItem('bd-current-user', JSON.stringify(currentUser));
            showApp();
        }

        function handleSignup(e) {
            e.preventDefault();
            const name = document.getElementById('signup-name').value.trim();
            const email = document.getElementById('signup-email').value.trim().toLowerCase();
            const password = document.getElementById('signup-password').value;
            const confirmPassword = document.getElementById('signup-confirm').value;
            
            // Validation
            if (password !== confirmPassword) {
                showError('signup-error', 'Passwords do not match.');
                return;
            }
            
            if (users[email]) {
                showError('signup-error', 'An account with this email already exists.');
                return;
            }
            
            // Create user
            const newUser = {
                name,
                email,
                password,
                dateJoined: new Date().toISOString(),
                works: []
            };
            
            users[email] = newUser;
            localStorage.setItem('bd-users', JSON.stringify(users));
            
            showSuccess('signup-success', 'Account created successfully! Please sign in.');
            setTimeout(() => showLogin(), 2000);
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                localStorage.removeItem('bd-current-user');
                currentUser = null;
                works = [];
                showAuth();
            }
        }

        // UI Functions
        function showAuth() {
            document.getElementById('auth-container').classList.remove('hidden');
            document.getElementById('app-container').classList.add('hidden');
        }

        function showApp() {
            document.getElementById('auth-container').classList.add('hidden');
            document.getElementById('app-container').classList.remove('hidden');
            
            // Load user data
            works = currentUser.works || [];
            document.getElementById('user-name').textContent = currentUser.name;
            document.getElementById('mobile-user-name').textContent = currentUser.name;
            document.getElementById('dashboard-name').textContent = currentUser.name.split(' ')[0];
            
            // Initialize app
            updateWordCount();
            showRandomTip();
            showSection('dashboard');
            updateDashboard();
            updateAnalytics();
        }

        function showLogin() {
            document.getElementById('login-page').classList.remove('hidden');
            document.getElementById('signup-page').classList.add('hidden');
            clearErrors();
        }

        function showSignup() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('signup-page').classList.remove('hidden');
            clearErrors();
        }

        function showError(elementId, message) {
            const errorEl = document.getElementById(elementId);
            errorEl.textContent = message;
            errorEl.classList.remove('hidden');
        }

        function showSuccess(elementId, message) {
            const successEl = document.getElementById(elementId);
            successEl.textContent = message;
            successEl.classList.remove('hidden');
        }

        function clearErrors() {
            document.querySelectorAll('[id$="-error"], [id$="-success"]').forEach(el => {
                el.classList.add('hidden');
            });
        }

        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById(`${section}-section`).classList.remove('hidden');
            
            // Update desktop nav
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('text-indigo-600');
                btn.classList.add('text-gray-600');
            });
            
            // Update mobile nav
            document.querySelectorAll('.mobile-nav-btn').forEach(btn => {
                btn.classList.remove('text-indigo-600', 'bg-indigo-50');
                btn.classList.add('text-gray-600', 'hover:bg-gray-50');
            });
            
            // Highlight active section
            if (event && event.target) {
                if (event.target.classList.contains('nav-btn')) {
                    event.target.classList.remove('text-gray-600');
                    event.target.classList.add('text-indigo-600');
                } else if (event.target.classList.contains('mobile-nav-btn')) {
                    event.target.classList.remove('text-gray-600', 'hover:bg-gray-50');
                    event.target.classList.add('text-indigo-600', 'bg-indigo-50');
                }
            }
            
            // Section-specific actions
            if (section === 'library') {
                displayWorks();
            } else if (section === 'analytics') {
                updateAnalytics();
            } else if (section === 'dashboard') {
                updateDashboard();
            }
        }
        
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }
        
        function closeMobileMenu() {
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        // Writing Functions
        function updateWordCount() {
            const content = document.getElementById('work-content').value;
            const words = content.trim() ? content.trim().split(/\s+/).length : 0;
            const chars = content.length;
            const paragraphs = content.split('\n\n').filter(p => p.trim()).length;
            const readTime = Math.ceil(words / 200); // Average reading speed
            
            document.getElementById('word-count').textContent = words;
            document.getElementById('char-count').textContent = chars;
            document.getElementById('para-count').textContent = paragraphs;
            document.getElementById('read-time').textContent = `${readTime} min`;
        }

        function showRandomTip() {
            const tip = writingTips[Math.floor(Math.random() * writingTips.length)];
            document.getElementById('writing-tip').textContent = tip;
        }

        function autoSave() {
            const title = document.getElementById('work-title').value.trim();
            const content = document.getElementById('work-content').value.trim();
            
            if (title || content) {
                const draft = {
                    title,
                    content,
                    type: document.getElementById('work-type').value,
                    tags: document.getElementById('work-tags').value,
                    lastSaved: new Date().toISOString()
                };
                
                localStorage.setItem(`bd-draft-${currentUser.email}`, JSON.stringify(draft));
                document.getElementById('last-saved').textContent = new Date().toLocaleTimeString();
                
                // Visual feedback
                const indicator = document.getElementById('save-indicator');
                indicator.classList.remove('bg-green-500');
                indicator.classList.add('bg-yellow-500');
                setTimeout(() => {
                    indicator.classList.remove('bg-yellow-500');
                    indicator.classList.add('bg-green-500');
                }, 500);
            }
        }

        function saveWork() {
            const title = document.getElementById('work-title').value.trim();
            const content = document.getElementById('work-content').value.trim();
            const type = document.getElementById('work-type').value;
            const tags = document.getElementById('work-tags').value.trim();
            
            if (!title || !content) {
                alert('Please enter both a title and content for your work.');
                return;
            }
            
            const work = {
                id: currentWorkId || Date.now(),
                title,
                content,
                type,
                tags: tags ? tags.split(',').map(tag => tag.trim()) : [],
                wordCount: content.trim().split(/\s+/).length,
                dateCreated: currentWorkId ? works.find(w => w.id === currentWorkId).dateCreated : new Date().toISOString(),
                dateModified: new Date().toISOString()
            };
            
            if (currentWorkId) {
                const index = works.findIndex(w => w.id === currentWorkId);
                works[index] = work;
            } else {
                works.unshift(work);
            }
            
            // Save to user account
            currentUser.works = works;
            users[currentUser.email] = currentUser;
            localStorage.setItem('bd-users', JSON.stringify(users));
            localStorage.setItem('bd-current-user', JSON.stringify(currentUser));
            localStorage.removeItem(`bd-draft-${currentUser.email}`);
            
            alert(currentWorkId ? 'Work updated successfully!' : 'Work saved successfully!');
            clearEditor();
            updateDashboard();
            updateAnalytics();
        }

        function clearEditor() {
            document.getElementById('work-title').value = '';
            document.getElementById('work-content').value = '';
            document.getElementById('work-tags').value = '';
            document.getElementById('work-type').value = 'poem';
            currentWorkId = null;
            updateWordCount();
            showRandomTip();
        }

        // Library Functions
        function displayWorks() {
            const grid = document.getElementById('works-grid');
            const filterType = document.getElementById('filter-type').value;
            const sortBy = document.getElementById('sort-by').value;
            
            let filteredWorks = filterType === 'all' ? [...works] : works.filter(w => w.type === filterType);
            
            // Sort works
            filteredWorks.sort((a, b) => {
                switch (sortBy) {
                    case 'oldest':
                        return new Date(a.dateCreated) - new Date(b.dateCreated);
                    case 'title':
                        return a.title.localeCompare(b.title);
                    case 'words':
                        return b.wordCount - a.wordCount;
                    default: // newest
                        return new Date(b.dateModified) - new Date(a.dateModified);
                }
            });
            
            document.getElementById('works-count').textContent = `${filteredWorks.length} work${filteredWorks.length !== 1 ? 's' : ''}`;
            
            if (filteredWorks.length === 0) {
                grid.innerHTML = `
                    <div class="text-center py-16 col-span-full">
                        <div class="text-6xl mb-4">📚</div>
                        <h3 class="text-xl font-semibold text-gray-600 mb-2">No works found</h3>
                        <p class="text-gray-500">Try adjusting your filters or start writing</p>
                    </div>
                `;
                return;
            }
            
            grid.innerHTML = filteredWorks.map(work => `
                <div class="bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 p-6 hover-lift cursor-pointer transition-all" onclick="openWork(${work.id})">
                    <div class="flex items-center justify-between mb-3">
                        <span class="inline-block bg-indigo-100 text-indigo-800 px-3 py-1 rounded-full text-xs font-semibold">${work.type}</span>
                        <span class="text-gray-400 text-xs">${new Date(work.dateModified).toLocaleDateString()}</span>
                    </div>
                    <h3 class="font-bold text-gray-800 mb-2 line-clamp-2">${work.title}</h3>
                    <p class="text-gray-600 text-sm line-clamp-3 font-serif leading-relaxed mb-4">${work.content}</p>
                    ${work.tags && work.tags.length > 0 ? `
                        <div class="flex flex-wrap gap-1 mb-3">
                            ${work.tags.slice(0, 3).map(tag => `<span class="bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs">${tag}</span>`).join('')}
                        </div>
                    ` : ''}
                    <div class="flex items-center justify-between text-xs text-gray-500">
                        <span>${work.wordCount} words</span>
                        <span>${Math.ceil(work.wordCount / 200)} min read</span>
                    </div>
                </div>
            `).join('');
        }

        function filterWorks() {
            displayWorks();
        }

        function openWork(id) {
            const work = works.find(w => w.id === id);
            if (!work) return;
            
            document.getElementById('modal-title').textContent = work.title;
            document.getElementById('modal-type').textContent = work.type;
            document.getElementById('modal-date').textContent = `Created: ${new Date(work.dateCreated).toLocaleDateString()}`;
            document.getElementById('modal-word-count').textContent = `${work.wordCount} words • ${Math.ceil(work.wordCount / 200)} min read`;
            document.getElementById('modal-content').textContent = work.content;
            
            // Display tags
            const tagsContainer = document.getElementById('modal-tags');
            if (work.tags && work.tags.length > 0) {
                tagsContainer.innerHTML = work.tags.map(tag => 
                    `<span class="inline-block bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm mr-2 mb-2">${tag}</span>`
                ).join('');
            } else {
                tagsContainer.innerHTML = '';
            }
            
            document.getElementById('work-modal').classList.remove('hidden');
            document.getElementById('work-modal').classList.add('flex');
            currentWorkId = id;
        }

        function closeModal() {
            document.getElementById('work-modal').classList.add('hidden');
            document.getElementById('work-modal').classList.remove('flex');
            currentWorkId = null;
        }

        function editWork() {
            const work = works.find(w => w.id === currentWorkId);
            if (!work) return;
            
            document.getElementById('work-title').value = work.title;
            document.getElementById('work-content').value = work.content;
            document.getElementById('work-type').value = work.type;
            document.getElementById('work-tags').value = work.tags ? work.tags.join(', ') : '';
            
            closeModal();
            showSection('write');
            updateWordCount();
        }

        function deleteWork() {
            if (!confirm('Are you sure you want to delete this work? This action cannot be undone.')) return;
            
            works = works.filter(w => w.id !== currentWorkId);
            currentUser.works = works;
            users[currentUser.email] = currentUser;
            localStorage.setItem('bd-users', JSON.stringify(users));
            localStorage.setItem('bd-current-user', JSON.stringify(currentUser));
            
            closeModal();
            displayWorks();
            updateDashboard();
            updateAnalytics();
        }

        function exportWork() {
            const work = works.find(w => w.id === currentWorkId);
            if (!work) return;
            
            const content = `${work.title}\n${'='.repeat(work.title.length)}\n\nCategory: ${work.type}\nCreated: ${new Date(work.dateCreated).toLocaleDateString()}\nWord Count: ${work.wordCount}\n${work.tags && work.tags.length > 0 ? `Tags: ${work.tags.join(', ')}\n` : ''}\n${work.content}`;
            downloadText(content, `${work.title}.txt`);
        }

        function exportCurrentWork() {
            const title = document.getElementById('work-title').value.trim();
            const content = document.getElementById('work-content').value.trim();
            
            if (!title || !content) {
                alert('Please enter both a title and content before exporting.');
                return;
            }
            
            const exportContent = `${title}\n${'='.repeat(title.length)}\n\n${content}`;
            downloadText(exportContent, `${title}.txt`);
        }

        function exportAllWorks() {
            if (works.length === 0) {
                alert('No works to export.');
                return;
            }
            
            const content = works.map(work => 
                `${work.title}\n${'='.repeat(work.title.length)}\n\nCategory: ${work.type}\nCreated: ${new Date(work.dateCreated).toLocaleDateString()}\nWord Count: ${work.wordCount}\n${work.tags && work.tags.length > 0 ? `Tags: ${work.tags.join(', ')}\n` : ''}\n${work.content}\n\n${'─'.repeat(60)}\n\n`
            ).join('');
            
            downloadText(content, `${currentUser.name.replace(/\s+/g, '_')}_Writing_Collection.txt`);
        }

        function downloadText(content, filename) {
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function clearAllWorks() {
            if (!confirm('Are you sure you want to delete all your works? This action cannot be undone.')) return;
            
            works = [];
            currentUser.works = works;
            users[currentUser.email] = currentUser;
            localStorage.setItem('bd-users', JSON.stringify(users));
            localStorage.setItem('bd-current-user', JSON.stringify(currentUser));
            
            displayWorks();
            updateDashboard();
            updateAnalytics();
        }

        // Dashboard Functions
        function updateDashboard() {
            const totalWorks = works.length;
            const totalWords = works.reduce((sum, work) => sum + work.wordCount, 0);
            
            document.getElementById('total-works').textContent = totalWorks;
            document.getElementById('total-words').textContent = totalWords.toLocaleString();
            
            // Recent works
            const recentWorksContainer = document.getElementById('recent-works');
            const recentWorks = works.slice(0, 5);
            
            if (recentWorks.length === 0) {
                recentWorksContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No works yet. Start writing to see them here!</p>';
            } else {
                recentWorksContainer.innerHTML = recentWorks.map(work => `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors cursor-pointer" onclick="openWork(${work.id})">
                        <div>
                            <h4 class="font-semibold text-gray-800">${work.title}</h4>
                            <p class="text-sm text-gray-600">${work.type} • ${work.wordCount} words</p>
                        </div>
                        <span class="text-xs text-gray-500">${new Date(work.dateModified).toLocaleDateString()}</span>
                    </div>
                `).join('');
            }
        }

        // Analytics Functions
        function updateAnalytics() {
            const totalWorks = works.length;
            const totalWords = works.reduce((sum, work) => sum + work.wordCount, 0);
            const avgWords = totalWorks > 0 ? Math.round(totalWords / totalWorks) : 0;
            
            document.getElementById('analytics-total-works').textContent = totalWorks;
            document.getElementById('analytics-total-words').textContent = totalWords.toLocaleString();
            document.getElementById('analytics-avg-words').textContent = avgWords;
            
            // Category breakdown
            const categoryStats = {};
            works.forEach(work => {
                categoryStats[work.type] = (categoryStats[work.type] || 0) + 1;
            });
            
            const categoryContainer = document.getElementById('category-stats');
            if (Object.keys(categoryStats).length === 0) {
                categoryContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No data available yet</p>';
            } else {
                categoryContainer.innerHTML = Object.entries(categoryStats).map(([type, count]) => `
                    <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                        <span class="capitalize font-medium">${type}</span>
                        <span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-sm font-semibold">${count}</span>
                    </div>
                `).join('');
            }
        }

        // Load draft on app start
        function loadDraft() {
            const draft = JSON.parse(localStorage.getItem(`bd-draft-${currentUser.email}`) || '{}');
            if (draft.title) document.getElementById('work-title').value = draft.title;
            if (draft.content) document.getElementById('work-content').value = draft.content;
            if (draft.type) document.getElementById('work-type').value = draft.type;
            if (draft.tags) document.getElementById('work-tags').value = draft.tags;
            if (draft.lastSaved) {
                document.getElementById('last-saved').textContent = new Date(draft.lastSaved).toLocaleTimeString();
            }
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                if (e.key === 's') {
                    e.preventDefault();
                    if (!document.getElementById('app-container').classList.contains('hidden')) {
                        saveWork();
                    }
                }
            }
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            const mobileMenu = document.getElementById('mobile-menu');
            const menuButton = e.target.closest('button[onclick="toggleMobileMenu()"]');
            
            if (!mobileMenu.contains(e.target) && !menuButton && !mobileMenu.classList.contains('hidden')) {
                closeMobileMenu();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'976853bd3584d65e',t:'MTc1NjQzMTQ4Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
